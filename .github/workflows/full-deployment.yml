name: Full Application Deployment

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Deployment environment'
        required: true
        default: 'development'
        type: choice
        options:
          - development
          - staging
          - production
      deploy_database:
        description: 'Setup/reset database server'
        required: false
        type: boolean
        default: false
      run_migrations:
        description: 'Run database migrations'
        required: true
        type: boolean
        default: true
      create_superuser:
        description: 'Create admin superuser'
        required: false
        type: boolean
        default: false
      deploy_app:
        description: 'Deploy app server'
        required: true
        type: boolean
        default: true

env:
  ENVIRONMENT: ${{ github.event.inputs.environment || 'development' }}

jobs:
  deployment-plan:
    runs-on: ubuntu-latest
    name: Deployment Plan
    
    steps:
      - name: Show deployment plan
        run: |
          cat << 'EOF'
          ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
          ‚ïë          FULL APPLICATION DEPLOYMENT ORCHESTRATION        ‚ïë
          ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
          
          üéØ DEPLOYMENT PLAN:
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          Environment: ${{ env.ENVIRONMENT }}
          Timestamp: $(date -u +%Y-%m-%dT%H:%M:%SZ)
          
          üìã PLANNED STEPS:
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          EOF
          
          if [ "${{ github.event.inputs.deploy_database }}" == "true" ]; then
            echo "  ‚òëÔ∏è 1. Setup Database Server (PostgreSQL)"
          else
            echo "  ‚òê 1. Setup Database Server (PostgreSQL) - SKIPPED"
          fi
          
          if [ "${{ github.event.inputs.run_migrations }}" == "true" ]; then
            echo "  ‚òëÔ∏è 2. Run Database Migrations"
          else
            echo "  ‚òê 2. Run Database Migrations - SKIPPED"
          fi
          
          if [ "${{ github.event.inputs.create_superuser }}" == "true" ]; then
            echo "  ‚òëÔ∏è 3. Create Django Superuser"
          else
            echo "  ‚òê 3. Create Django Superuser - SKIPPED"
          fi
          
          if [ "${{ github.event.inputs.deploy_app }}" == "true" ]; then
            echo "  ‚òëÔ∏è 4. Deploy Application Server"
          else
            echo "  ‚òê 4. Deploy Application Server - SKIPPED"
          fi
          
          echo ""
          echo "üîê SECURITY CHECKS:"
          echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
          
          if [ -z "${{ secrets.DEV_SSH_PRIVATE_KEY }}" ]; then
            echo "  ‚ùå DEV_SSH_PRIVATE_KEY not configured"
          else
            echo "  ‚úÖ SSH credentials configured"
          fi
          
          if [ -z "${{ secrets.DB_SSH_PRIVATE_KEY }}" ]; then
            echo "  ‚ùå DB_SSH_PRIVATE_KEY not configured"
          else
            echo "  ‚úÖ Database SSH credentials configured"
          fi
          
          echo ""
          echo "‚è±Ô∏è ESTIMATED DURATION:"
          echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
          echo "  Database Setup: ~5 minutes"
          echo "  Migrations: ~2 minutes"
          echo "  App Deploy: ~10 minutes"
          echo "  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
          echo "  TOTAL: ~15-20 minutes (depends on options)"

  setup-database:
    if: github.event.inputs.deploy_database == 'true'
    runs-on: ubuntu-latest
    name: Step 1 - Setup Database Server
    
    env:
      DB_SERVER_IP: ${{ secrets.DB_SERVER_IP }}
      DB_SERVER_USER: ${{ secrets.DB_SERVER_USER }}
      DB_SERVER_PORT: ${{ secrets.DB_SERVER_PORT }}
      SSH_PRIVATE_KEY: ${{ secrets.DB_SSH_PRIVATE_KEY }}
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup SSH
        run: |
          mkdir -p ~/.ssh
          echo "$SSH_PRIVATE_KEY" | base64 -d > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan -H ${{ env.DB_SERVER_IP }} >> ~/.ssh/known_hosts 2>/dev/null
          echo "‚úÖ SSH configured"
        env:
          SSH_PRIVATE_KEY: ${{ secrets.DB_SSH_PRIVATE_KEY }}
      
      - name: Install PostgreSQL on Database Server
        run: |
          ssh -p ${{ env.DB_SERVER_PORT }} ${{ env.DB_SERVER_USER }}@${{ env.DB_SERVER_IP }} << 'EOF'
          echo "üì¶ Installing PostgreSQL on database server..."
          sudo apt-get update -qq
          sudo apt-get install -y postgresql postgresql-contrib postgresql-client 2>&1 | tail -5
          sudo systemctl start postgresql
          sudo systemctl enable postgresql
          echo "‚úÖ PostgreSQL installed and running"
          EOF

  run-migrations:
    if: github.event.inputs.run_migrations == 'true'
    needs: [deployment-plan]
    runs-on: ubuntu-latest
    name: Step 2 - Run Migrations
    
    env:
      APP_SERVER_IP: ${{ secrets.DEV_APP_SERVER_IP }}
      APP_SERVER_USER: ${{ secrets.DEV_APP_SERVER_USER }}
      APP_SERVER_PORT: ${{ secrets.DEV_APP_SERVER_PORT }}
      SSH_PRIVATE_KEY: ${{ secrets.DEV_SSH_PRIVATE_KEY }}
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup SSH
        run: |
          mkdir -p ~/.ssh
          echo "$SSH_PRIVATE_KEY" | base64 -d > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan -H ${{ env.APP_SERVER_IP }} >> ~/.ssh/known_hosts 2>/dev/null
          echo "‚úÖ SSH configured"
        env:
          SSH_PRIVATE_KEY: ${{ secrets.DEV_SSH_PRIVATE_KEY }}
      
      - name: Run Django Migrations
        run: |
          ssh -p ${{ env.APP_SERVER_PORT }} ${{ env.APP_SERVER_USER }}@${{ env.APP_SERVER_IP }} << 'EOF'
          echo "üîÑ Running database migrations..."
          
          if [ -f "manage.py" ]; then
            export ENVIRONMENT=${{ env.ENVIRONMENT }}
            python manage.py migrate --noinput
            echo "‚úÖ Migrations completed"
          else
            echo "‚ö†Ô∏è manage.py not found"
          fi
          EOF

  create-admin:
    if: github.event.inputs.create_superuser == 'true'
    needs: [run-migrations]
    runs-on: ubuntu-latest
    name: Step 3 - Create Superuser
    
    env:
      APP_SERVER_IP: ${{ secrets.DEV_APP_SERVER_IP }}
      APP_SERVER_USER: ${{ secrets.DEV_APP_SERVER_USER }}
      APP_SERVER_PORT: ${{ secrets.DEV_APP_SERVER_PORT }}
      SSH_PRIVATE_KEY: ${{ secrets.DEV_SSH_PRIVATE_KEY }}
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup SSH
        run: |
          mkdir -p ~/.ssh
          echo "$SSH_PRIVATE_KEY" | base64 -d > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan -H ${{ env.APP_SERVER_IP }} >> ~/.ssh/known_hosts 2>/dev/null
        env:
          SSH_PRIVATE_KEY: ${{ secrets.DEV_SSH_PRIVATE_KEY }}
      
      - name: Create Superuser
        run: |
          ssh -p ${{ env.APP_SERVER_PORT }} ${{ env.APP_SERVER_USER }}@${{ env.APP_SERVER_IP }} << 'EOF'
          echo "üë§ Creating Django superuser..."
          
          export ENVIRONMENT=${{ env.ENVIRONMENT }}
          
          python manage.py shell << 'PYEOF'
          from django.contrib.auth.models import User
          if not User.objects.filter(username='admin').exists():
              User.objects.create_superuser('admin', 'admin@company.com', 'admin123')
              print("‚úÖ Superuser 'admin' created")
          else:
              print("‚ö†Ô∏è Superuser 'admin' already exists")
          PYEOF
          EOF

  deploy-app:
    if: github.event.inputs.deploy_app == 'true'
    needs: [deployment-plan]
    runs-on: ubuntu-latest
    name: Step 4 - Deploy Application Server
    
    env:
      APP_SERVER_IP: ${{ secrets.DEV_APP_SERVER_IP }}
      APP_SERVER_USER: ${{ secrets.DEV_APP_SERVER_USER }}
      APP_SERVER_PORT: ${{ secrets.DEV_APP_SERVER_PORT }}
      SSH_PRIVATE_KEY: ${{ secrets.DEV_SSH_PRIVATE_KEY }}
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup SSH
        run: |
          mkdir -p ~/.ssh
          echo "$SSH_PRIVATE_KEY" | base64 -d > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan -H ${{ env.APP_SERVER_IP }} >> ~/.ssh/known_hosts 2>/dev/null
        env:
          SSH_PRIVATE_KEY: ${{ secrets.DEV_SSH_PRIVATE_KEY }}
      
      - name: Deploy Application
        run: |
          ssh -p ${{ env.APP_SERVER_PORT }} ${{ env.APP_SERVER_USER }}@${{ env.APP_SERVER_IP }} << 'EOF'
          echo "üöÄ Deploying application..."
          
          # Pull latest code
          if [ -d "erp" ]; then
            cd erp
            git pull origin main
          else
            git clone https://github.com/tradifyglobal/Applications.git erp
            cd erp
          fi
          
          # Update environment
          export ENVIRONMENT=${{ env.ENVIRONMENT }}
          
          # Install dependencies
          if [ -d "venv" ]; then
            source venv/bin/activate
          else
            python3 -m venv venv
            source venv/bin/activate
          fi
          
          pip install -q -r requirements.txt
          
          # Collect static files
          python manage.py collectstatic --noinput
          
          echo "‚úÖ Application deployed"
          EOF

  deployment-summary:
    needs: [deployment-plan, setup-database, run-migrations, create-admin, deploy-app]
    runs-on: ubuntu-latest
    if: always()
    name: Deployment Summary
    
    steps:
      - name: Generate summary
        run: |
          cat << 'EOF'
          ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
          ‚ïë              DEPLOYMENT COMPLETION SUMMARY               ‚ïë
          ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
          
          üéØ DEPLOYMENT STATUS:
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          Environment: ${{ env.ENVIRONMENT }}
          Execution Duration: $(date)
          
          üìä RESULTS:
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
          EOF
          
          case "${{ job.status }}" in
            "success")
              echo "  ‚úÖ Deployment completed successfully"
              echo ""
              echo "üöÄ DEPLOYMENT COMPLETE"
              echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
              ;;
            "failure")
              echo "  ‚ùå Deployment failed"
              echo ""
              echo "Please review the logs above for errors"
              echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
              ;;
            "cancelled")
              echo "  ‚ö†Ô∏è Deployment cancelled"
              echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
              ;;
          esac
          
          echo ""
          echo "üìö NEXT STEPS:"
          echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
          echo "  1. Verify application accessibility"
          echo "  2. Test API endpoints"
          echo "  3. Monitor server logs"
          echo "  4. Perform smoke tests"
          echo ""
          echo "üìñ DOCUMENTATION:"
          echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
          echo "  GitHub Actions Guide: docs/GITHUB_ACTIONS_DEPLOYMENT.md"
          echo "  Troubleshooting: docs/DEPLOYMENT_SETUP_COMPLETE.md"
          echo "  API Documentation: README/06-API_DOCUMENTATION.md"

  post-deployment-checklist:
    needs: deployment-summary
    runs-on: ubuntu-latest
    if: always()
    name: Post-Deployment Checklist
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Create post-deployment checklist
        run: |
          cat > POST_DEPLOYMENT_CHECKLIST.md << 'EOF'
          # Post-Deployment Checklist - ${{ env.ENVIRONMENT }}
          
          > Generated: $(date)
          
          ## üîç Health Checks
          
          - [ ] Application server is responding to HTTP requests
          - [ ] HTTPS/SSL is working correctly
          - [ ] Database connectivity verified
          - [ ] All Django admin pages loading
          - [ ] API endpoints responding correctly
          - [ ] WebSocket connections established (if applicable)
          - [ ] Background tasks/Celery working (if applicable)
          
          ## üìä Database Verification
          
          - [ ] All migrations have been applied
          - [ ] Database user has correct permissions
          - [ ] Connection pooling is working
          - [ ] Backup schedules are configured
          - [ ] Database logs show no errors
          
          ## üîê Security Verification
          
          - [ ] HTTPS is enforced
          - [ ] CSRF protection is enabled
          - [ ] Security headers are present
          - [ ] Debug mode is disabled (non-dev)
          - [ ] Secrets are not exposed in logs
          - [ ] API keys are rotated
          - [ ] SSH key-based access verified
          
          ## üìà Performance Baseline
          
          - [ ] Response time baseline established
          - [ ] Load testing completed
          - [ ] Cache is warmed up
          - [ ] CDN is configured (if applicable)
          - [ ] Static files are optimized
          - [ ] Database query performance verified
          
          ## üìù Documentation
          
          - [ ] Deployment notes added to runbook
          - [ ] Configuration changes documented
          - [ ] Troubleshooting steps updated
          - [ ] Team notified of deployment
          
          ## üîÑ Rollback Plan
          
          - [ ] Previous version backed up
          - [ ] Rollback procedure tested
          - [ ] Team understands rollback process
          - [ ] Rollback runbook is accessible
          
          ## ‚úÖ Sign-Off
          
          - [ ] Deployment verified by team
          - [ ] Stakeholders notified
          - [ ] Incident response team on alert
          - [ ] Monitoring alerts configured
          EOF
          
          cat POST_DEPLOYMENT_CHECKLIST.md
      
      - name: Display completion message
        run: |
          echo "‚úÖ Deployment workflow completed"
          echo ""
          echo "üìã Post-deployment checklist created: POST_DEPLOYMENT_CHECKLIST.md"
          echo ""
          echo "üéØ Next actions:"
          echo "  1. Review the checklist above"
          echo "  2. Perform manual verification tests"
          echo "  3. Monitor application for issues"
          echo "  4. Update documentation if needed"
